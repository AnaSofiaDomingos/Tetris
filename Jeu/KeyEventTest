import scala.swing._
import scala.swing.event._
import java.awt.{ Color, Graphics2D }
import Array._
import java.awt.event._
/**
 * Created by contisa on 01.09.14.
 */

object KeyEventTest extends SimpleSwingApplication {
  private var grid = new Map
  private var p = grid.invoke

  def top = new MainFrame {

      title = "Tetris"
      preferredSize = new Dimension(600, 800)
      var tabButtons = ofDim[Button](22,10)

      contents = new GridPanel(22,10){
        val x:Int = 22
        var y:Int = 10

        for( i <- 0 until x){
          for( j <- 0 until y) {
            tabButtons(i)(j) = new Button()
            contents += tabButtons(i)(j)
          }
        }

        //tabButtons(2)(4).background = Color.red

        listenTo(keys)
        reactions += {
          case KeyPressed(_, Key.Right, _, _) =>
            //label.text = "Space is down"
            if (grid.canGoRight(p)) grid.right(p)
            tabButtons(2)(4).background = Color.red
            grid.display

          case KeyPressed(_, Key.Left, _, _) =>
            //label.text = "Space is up"
            if (grid.canGoLeft(p)) grid.left(p)
            grid.display
          case KeyPressed(_, Key.Down, _, _) =>
            if (grid.canGoDown(p)) grid.down(p)
        }
        focusable = true
        requestFocus

        val timer=new javax.swing.Timer(1000, Swing.ActionListener(e =>
        {
          //RunningGame
         // grid.display

        }))
        timer.start()
      }
  }

  def RunningGame(): Unit = {
    //On check si on peut d√©scendre
    if (grid.canGoDown(p))
      grid.down(p)
    else {
      grid.clean
      p = grid.invoke
    }

  }

}
